<!DOCTYPE html>
<html>
    <head>
        <title>Firmware : Endurance Mode Testing Plans</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">Firmware</a></span>
                            </li>
                                                    <li>
                                <span><a href="Firmware_9465365086.html">Firmware</a></span>
                            </li>
                                                    <li>
                                <span><a href="Firmware-Projects_9571009451.html">Firmware Projects</a></span>
                            </li>
                                                    <li>
                                <span><a href="Endurance-Mode_19415171148.html">Endurance Mode</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            Firmware : Endurance Mode Testing Plans
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                        
        
    
        
    
        
        
            Created by <span class='author'> Justin Vuong</span> on Jul 31, 2022
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p>Components to validate:</p><ol><li><p>SoC Algo</p><ol><li><p>Validate IR adjustments on Voltage </p></li><li><p>Soc interpolation accuracy</p></li></ol></li><li><p>Validate buttons work</p></li><li><p>Throttle Adjustment</p></li><li><p>Tune Ki, Kp values</p></li></ol><p /><p><strong>Validate SoC Algo </strong></p><p>Validate IR adjustments on segment voltage readings </p><ul><li><p>Put the car on the stilts and get the car to EM </p></li><li><p>Test segment voltage readings while motors are not moving (IBus = 0)</p><ul><li><p>Connect to the BMU and run the CLI command “soc”. You want to make sure that the segment voltage reported is roughly the pack voltage/5 which can be found by calling “battInfo“</p></li></ul></li><li><p>Run the motors and while they are moving run the “soc“ command again</p><ul><li><p>We want to see a non zero IBus reading and the segment voltage should not be significantly different from when the motors were off</p></li></ul></li></ul><p /><p><strong>Soc interpolation accuracy</strong></p><ul><li><p>Based off the segment voltage in the previous test make sure that the soc reported when you called the “soc“ command is consistent with the look up tables below.</p></li></ul><div id="expander-318733828" class="expand-container"><div id="expander-control-318733828" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"></span><span class="expand-control-text">Voltage SOC look up table values</span></div><div id="expander-content-318733828" class="expand-content"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">//The index is calculated using the number of 0.1V steps above 56V the reading is
const float highVoltageSocLut[HV_SOC_LUT_LEN] = 
{
    0.94200, //56.0 V
    0.95159, //56.1 V
    0.95786, //56.2 V
    0.96432, //56.3 V
    0.96929, //56.4 V
    0.97421, //56.5 V
    0.97783, //56.6 V
    0.98146, //56.7 V
    0.98464, //56.8 V
    0.98679, //56.9 V
    0.98895, //57.0 V
    0.99110, //57.1 V
    0.99325, //57.2 V
    0.99405  //57.3 V
};

const float midVoltageSocLut[MID_SOC_LUT_LEN] = 
{
    0.13283,    // 45V
    0.16790,    // 46V
    0.22169,    // 47V
    0.29539,    // 48V
    0.38091,    // 49V
    0.45930,    // 50V
    0.52878,    // 51V
    0.60245,    // 52V
    0.68764,    // 53V
    0.75858,    // 54V
    0.82780,    // 55V
    0.94200,    // 56V
    0.98895,    // 57V
};

//the index is calculated using the number of volts above 36V the reading is
const float lowVoltageSocLut[LV_SOC_LUT_LEN] = 
{
    0.01114,  //38V
    0.02005,  //39V
    0.03124,  //40V
    0.04488,  //41V 
    0.06144,  //42V 
    0.08186,  //43V 
    0.10583,  //44V 
    0.13283,  //45V 
    0.16790   //46V
};</pre>
</div></div></div></div><p /><p><strong>Validate buttons work</strong></p><ul><li><p>When pushing the TV or TC button you should see “Received DCU button Event“ in the VCU’s CLI</p></li></ul><p /><p><strong>Throttle Adjustment</strong></p><ul><li><p>Call “currentLimit 1“ on the VCU’s CLI and verify that it was set by the message it prints. Then slowly press down the throttle until the current limit is hit and the motors should hit a top speed. If the MC pull a current &lt;= 1Amp then then this works</p></li></ul><p /><p><strong>Tune Ki, Kp values</strong></p><ul><li><p>We are going to have to run multiple endurance mode and see how the calcualted values for Kp and Ki hold. If there is too much steady state error then adjust Ki. If the response is too slow then adjust Kp.</p></li><li><p>The race should end with a 5% battery soc</p></li></ul>
                    </div>

                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on Oct 15, 2022 01:33</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
